<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    ul, li {
        list-style: none;
    }
    .wrap {
        width: 900px;
        margin: 0 auto;
    }
    .clearfix {
        content: "";
        display: block;
        clear: both;
    }
    #pic-ct {
        position: relative;
    }
    #pic-ct .item {
        position: absolute;
        padding: 0 0 10px 0;
        margin: 10px;
        border: 1px solid #DFDFDF;
        opacity: 0;
        transition: all .8s;
    }
    #pic-ct .item img {
        margin: 10px;
        width: 260px;
    }
    #pic-ct .item .header {
        height: 25px;
        margin: 0 12px;
        border-bottom: 1px solid #DBDBDB;
    }
    #pic-ct .desp {
        font-size: 12px;
        line-height: 1.8;
        margin: 10px 15px 0;
        color: #777371;
    }
    #load {
        visibility: hidden;
        height: 20px;
    }
    .hide {
        display: none;
    }
</style>
<body>
    <div class="wrap">
        <div class="waterfall">
            <ul id="pic-ct" class="ct clearfix">
                <li class="item">
                    <a href="#"><img src="" alt=""></a>
                    <h4 class="header">标题</h4>
                    <p class="desp">当地时间2016年3月1日，在东部与亲俄武装作战中受伤的乌克兰士兵接受海豚治疗。</p>
                </li>
                
            </ul>
            <div class="load">圈圈</div>
        </div>
    </div>
</body>
<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
//1. ajax请求数据
//2. 数据渲染dom
//3. 瀑布流布局摆放
//4. 页面滚动到底部，重复123

var curPage = 1
var perPageCount = 10
//初始化瀑布流数据
var colSumHeight = []
var nodeWidth = $(".item").outerWidth(true)
var colNum = parseInt($("#pic-ct").width()/nodeWidth)
for(let i=0;i < colNum.length; i++){
    colSumHeight = 0
}

var isData
//ajax请求
function getData(callback){
    $.ajax({
        url: "http://platform.sina.com.cn/slide/album_tech",
        dataType: "jsonp",
        data: {
            app_key: '1271687855',
            num: perPageCount,
            page: curPage
        }
    }).done(function(ret){
        if(ret && ret.status && ret.status.code === "0"){
            callback(ret.data);
        }else{
            console.log("get error data");
        }
    })
}
//渲染dom
function getNode(item){
    var tpl = ''
        tpl = '<li class="item">'
        tpl = '<a href="'+ item.url+'"><img src="'+ item.img_url +'" alt=""></a>'
        tpl = '<h4 class="header">'+ item.short_name +'</h4>'
        tpl = '<p class="'+item.short_intro+'"></p>'
        tpl = '</li>'
    var $tpl =$(tpl)
    return $tpl
}

//瀑布流布局
function waterFallPlace($node){
    var index = 0,
        minSumHeight = colSumHeight[0];
    for(var i=0;i<colSumHeight.length; i++){
        if(colSumHeight[i] < minSumHeight[i]){
            index = i;
            minSumHeight = colSumHeight[i];
        }
    }
    $node.css({
        left: nodeWidth *index,
        top: minSumHeight,
        opacity: 1
    });
    colSumHeight[index] = $node.outerHeight(true) + colSumHeight[index];
    $("#pic-ct").height(Math.floor)
}
</script>
</html>